2019-04-29 19:47:48.362338: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
2019-04-29 19:47:48.655874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties:
name: GeForce GTX 1070 major: 6 minor: 1 memoryClockRate(GHz): 1.7845
pciBusID: 0000:01:00.0
totalMemory: 8.00GiB freeMemory: 6.64GiB
2019-04-29 19:47:48.667980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-04-29 19:47:49.822481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-04-29 19:47:49.828026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0
2019-04-29 19:47:49.830787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N
2019-04-29 19:47:49.834225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6397 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:01:00.0, compute capability: 6.1)
Epoch: 1 Learning rate: 1.000
0.004 perplexity: 6126.901 speed: 7134 wps
0.104 perplexity: 834.851 speed: 19827 wps
0.204 perplexity: 616.766 speed: 20858 wps
0.304 perplexity: 497.066 speed: 21451 wps
0.404 perplexity: 428.981 speed: 21844 wps
0.504 perplexity: 384.391 speed: 22081 wps
0.604 perplexity: 346.731 speed: 22375 wps
0.703 perplexity: 320.786 speed: 22588 wps
0.803 perplexity: 300.382 speed: 22746 wps
0.903 perplexity: 281.610 speed: 23011 wps
Epoch: 1 Train Perplexity: 267.641
Epoch: 1 Valid Perplexity: 184.479
Epoch: 2 Learning rate: 1.000
0.004 perplexity: 203.034 speed: 25295 wps
0.104 perplexity: 151.301 speed: 26960 wps
0.204 perplexity: 158.465 speed: 27000 wps
0.304 perplexity: 153.188 speed: 26288 wps
0.404 perplexity: 150.488 speed: 25681 wps
0.504 perplexity: 147.885 speed: 25362 wps
0.604 perplexity: 143.297 speed: 25572 wps
0.703 perplexity: 141.132 speed: 25616 wps
0.803 perplexity: 139.131 speed: 25589 wps
0.903 perplexity: 135.507 speed: 25576 wps
Epoch: 2 Train Perplexity: 133.512
Epoch: 2 Valid Perplexity: 145.470
Epoch: 3 Learning rate: 1.000
0.004 perplexity: 138.714 speed: 22006 wps
0.104 perplexity: 104.917 speed: 23646 wps
0.204 perplexity: 114.146 speed: 24754 wps
0.304 perplexity: 110.983 speed: 25397 wps
0.404 perplexity: 110.163 speed: 25844 wps
0.504 perplexity: 109.253 speed: 26066 wps
0.604 perplexity: 106.734 speed: 26019 wps
0.703 perplexity: 106.091 speed: 25711 wps
0.803 perplexity: 105.490 speed: 25519 wps
0.903 perplexity: 103.271 speed: 25612 wps
Epoch: 3 Train Perplexity: 102.390
Epoch: 3 Valid Perplexity: 132.631
Epoch: 4 Learning rate: 1.000
0.004 perplexity: 109.495 speed: 26516 wps
0.104 perplexity: 84.931 speed: 26603 wps
0.204 perplexity: 93.466 speed: 26807 wps
0.304 perplexity: 90.881 speed: 25851 wps
0.404 perplexity: 90.684 speed: 25433 wps
0.504 perplexity: 90.171 speed: 25324 wps
0.604 perplexity: 88.423 speed: 25553 wps
0.703 perplexity: 88.228 speed: 25752 wps
0.803 perplexity: 88.011 speed: 25930 wps
0.903 perplexity: 86.425 speed: 26066 wps
Epoch: 4 Train Perplexity: 85.926
Epoch: 4 Valid Perplexity: 127.529
Epoch: 5 Learning rate: 0.500
0.004 perplexity: 94.338 speed: 24452 wps
0.104 perplexity: 70.695 speed: 24061 wps
0.204 perplexity: 76.987 speed: 24827 wps
0.304 perplexity: 73.968 speed: 25553 wps
0.404 perplexity: 73.100 speed: 25889 wps
0.504 perplexity: 72.034 speed: 26011 wps
0.604 perplexity: 70.019 speed: 25979 wps
0.703 perplexity: 69.256 speed: 25722 wps
0.803 perplexity: 68.477 speed: 25504 wps
0.903 perplexity: 66.627 speed: 25535 wps
Epoch: 5 Train Perplexity: 65.681
Epoch: 5 Valid Perplexity: 118.973
Epoch: 6 Learning rate: 0.250
0.004 perplexity: 78.217 speed: 27508 wps
0.104 perplexity: 58.363 speed: 26815 wps
0.204 perplexity: 63.723 speed: 27007 wps
0.304 perplexity: 61.162 speed: 26386 wps
0.404 perplexity: 60.380 speed: 25778 wps
0.504 perplexity: 59.388 speed: 25573 wps
0.604 perplexity: 57.615 speed: 25848 wps
0.703 perplexity: 56.856 speed: 26047 wps
0.803 perplexity: 56.067 speed: 26212 wps
0.903 perplexity: 54.365 speed: 26318 wps
Epoch: 6 Train Perplexity: 53.432
Epoch: 6 Valid Perplexity: 118.209
Epoch: 7 Learning rate: 0.125
0.004 perplexity: 68.943 speed: 23044 wps
0.104 perplexity: 51.891 speed: 24037 wps
0.204 perplexity: 56.730 speed: 24715 wps
0.304 perplexity: 54.441 speed: 25401 wps
0.404 perplexity: 53.761 speed: 25690 wps
0.504 perplexity: 52.774 speed: 25966 wps
0.604 perplexity: 51.149 speed: 25993 wps
0.703 perplexity: 50.430 speed: 25742 wps
0.803 perplexity: 49.643 speed: 25567 wps
0.903 perplexity: 48.057 speed: 25608 wps
Epoch: 7 Train Perplexity: 47.173
Epoch: 7 Valid Perplexity: 119.234
Epoch: 8 Learning rate: 0.062
0.004 perplexity: 61.812 speed: 25590 wps
0.104 perplexity: 48.562 speed: 27132 wps
0.204 perplexity: 53.189 speed: 27176 wps
0.304 perplexity: 50.985 speed: 26511 wps
0.404 perplexity: 50.360 speed: 25884 wps
0.504 perplexity: 49.420 speed: 25565 wps
0.604 perplexity: 47.873 speed: 25840 wps
0.703 perplexity: 47.170 speed: 26032 wps
0.803 perplexity: 46.390 speed: 26201 wps
0.903 perplexity: 44.874 speed: 26318 wps
Epoch: 8 Train Perplexity: 44.007
Epoch: 8 Valid Perplexity: 119.907
Epoch: 9 Learning rate: 0.031
0.004 perplexity: 59.328 speed: 23412 wps
0.104 perplexity: 46.808 speed: 23640 wps
0.204 perplexity: 51.315 speed: 24451 wps
0.304 perplexity: 49.180 speed: 25266 wps
0.404 perplexity: 48.584 speed: 25648 wps
0.504 perplexity: 47.670 speed: 25865 wps
0.604 perplexity: 46.172 speed: 25962 wps
0.703 perplexity: 45.473 speed: 25684 wps
0.803 perplexity: 44.693 speed: 25568 wps
0.903 perplexity: 43.210 speed: 25399 wps
Epoch: 9 Train Perplexity: 42.361
Epoch: 9 Valid Perplexity: 119.987
Epoch: 10 Learning rate: 0.016
0.004 perplexity: 57.987 speed: 22924 wps
0.104 perplexity: 45.759 speed: 24020 wps
0.204 perplexity: 50.230 speed: 23563 wps
0.304 perplexity: 48.148 speed: 22941 wps
0.404 perplexity: 47.577 speed: 22803 wps
0.504 perplexity: 46.671 speed: 23028 wps
0.604 perplexity: 45.226 speed: 22976 wps
0.703 perplexity: 44.534 speed: 23309 wps
0.803 perplexity: 43.737 speed: 23734 wps
0.903 perplexity: 42.288 speed: 24071 wps
Epoch: 10 Train Perplexity: 41.458
Epoch: 10 Valid Perplexity: 119.844
Epoch: 11 Learning rate: 0.008
0.004 perplexity: 56.815 speed: 23288 wps
0.104 perplexity: 45.043 speed: 23646 wps
0.204 perplexity: 49.607 speed: 23642 wps
0.304 perplexity: 47.534 speed: 23838 wps
0.404 perplexity: 47.018 speed: 23814 wps
0.504 perplexity: 46.102 speed: 24020 wps
0.604 perplexity: 44.680 speed: 24436 wps
0.703 perplexity: 44.001 speed: 24798 wps
0.803 perplexity: 43.211 speed: 25081 wps
0.903 perplexity: 41.773 speed: 25305 wps
Epoch: 11 Train Perplexity: 40.948
Epoch: 11 Valid Perplexity: 119.562
Epoch: 12 Learning rate: 0.004
0.004 perplexity: 56.375 speed: 23662 wps
0.104 perplexity: 44.700 speed: 24151 wps
0.204 perplexity: 49.269 speed: 25140 wps
0.304 perplexity: 47.220 speed: 25792 wps
0.404 perplexity: 46.714 speed: 26081 wps
0.504 perplexity: 45.803 speed: 26272 wps
0.604 perplexity: 44.391 speed: 26315 wps
0.703 perplexity: 43.717 speed: 26002 wps
0.803 perplexity: 42.931 speed: 25784 wps
0.903 perplexity: 41.498 speed: 25563 wps
Epoch: 12 Train Perplexity: 40.677
Epoch: 12 Valid Perplexity: 119.295
Epoch: 13 Learning rate: 0.002
0.004 perplexity: 56.128 speed: 24184 wps
0.104 perplexity: 44.508 speed: 25500 wps
0.204 perplexity: 49.074 speed: 26262 wps
0.304 perplexity: 47.044 speed: 26575 wps
0.404 perplexity: 46.547 speed: 26715 wps
0.504 perplexity: 45.639 speed: 26704 wps
0.604 perplexity: 44.234 speed: 26246 wps
0.703 perplexity: 43.575 speed: 25938 wps
0.803 perplexity: 42.776 speed: 25908 wps
0.903 perplexity: 41.354 speed: 26010 wps
Epoch: 13 Train Perplexity: 40.548
Epoch: 13 Valid Perplexity: 119.047
Test Perplexity: 114.770
Saving model to ./model.